var op=-1!=navigator.userAgent.indexOf("Opera")&&document.getElementById,ie4=document.all,ns4=document.layers,ns6=!document.all&&document.getElementById,ZERO_NO=1,ZERO_OK=2,MASK_NO=4,MASK_OK=8,BCST_NO=16,BCST_OK=32,SPACE_NO=1,SPACE_OK=2;function addClass(e,t){var n=e.className;-1==n.indexOf(t)&&(null==n||""===n?e.className=t:e.className+=" "+t)}function removeClass(e,t){var n=e.className;if(n!=t){for(var l=n.split(" "),i=[],a=0;a<l.length;a++)t!=l[a]&&i.push(l[a]);e.className=i.join(" ")}else e.className=""}function choose_enable(e){e&&(e.disabled=!1,ns4||removeClass(e,"off"))}function choose_disable(e){e&&(e.disabled=!0,ns4||addClass(e,"off"))}function check_action(e,t){ns4&&(0==t?1==EN_DIS?e.focus():e.blur():1==t?1==EN_DIS1?e.focus():e.blur():2==t?1==EN_DIS2?e.focus():e.blur():3==t&&(1==EN_DIS3?e.focus():e.blur()))}function check_action1(e,t,n){ns4&&(0==n&&(1==EN_DIS?e.focus():e.value=e.defaultChecked),1==n&&(1==EN_DIS1?e.focus():e.value=e.defaultChecked))}function valid_range(e,t,n,l){return M1=unescape(l),!!isdigit(e,M1)&&(d=parseInt(e.value,10),d<=n&&d>=t?(e.value=d,!0):(alert(M1+errmsg.err14+t+" - "+n+"]."),e.value=e.defaultValue,!1))}function valid_psk_length(e){return""==e.value||(e.value.length<8||64<e.value.length)&&(alert(errmsg.err39),e.value=e.defaultValue),!0}function valid_macs_all(e){return""==e.value||(12==e.value.length?valid_macs_12(e):17==e.value.length?valid_macs_17(e):(alert(errmsg.err5),e.value=e.defaultValue)),!0}function valid_macs_list(e){if(""==e.value)return!0;e.value=e.value.replace("\n"," ");for(var t=e.value.split(" "),n=!0,l="";0<t.length;){var i=new Object;i.value=t.shift(),valid_macs_17(i)?l=l+" "+i.value:n=!1}for(;0==l.indexOf(" ");)l=l.substr(1);return e.value=l,n}function valid_mac(e,t){var n,l;1==e.value.length&&(e.value="0"+e.value),n=parseInt(e.value.charAt(0),16),l=parseInt(e.value.charAt(1),16),(isNaN(n)||isNaN(l))&&(alert(errmsg.err15),e.value=e.defaultValue),e.value=e.value.toUpperCase(),0==t&&1==(1&l)&&(alert(errmsg.err16),e.value=e.defaultValue)}function valid_macs_12(e){var t;if(""==e.value)return!0;if(12==e.value.length){for(i=0;i<12&&(t=parseInt(e.value.charAt(i),16),!isNaN(t));i++);12!=i&&(alert(errmsg.err17),e.value=e.defaultValue)}else alert(errmsg.err18),e.value=e.defaultValue;return e.value=e.value.toUpperCase(),"FFFFFFFFFFFF"==e.value&&(alert(errmsg.err19),e.value=e.defaultValue),1==(1&e.value.charAt(1))&&(alert(errmsg.err16),e.value=e.defaultValue),!0}function valid_domain(e){var t;if(""==e.value)return alert(errmsg.err113),!0;if(4==e.value.length){for(i=0;i<4&&(t=parseInt(e.value.charAt(i),16),!isNaN(t));i++);4!=i&&(alert(errmsg.err113),e.value=e.defaultValue)}else alert(errmsg.err113),e.value=e.defaultValue;return!0}function valid_email(e,t,n){if(""==e&&t)return n&&alert("email address is mandatory"),!1;if(""==e)return!0;var l="/'\\ \";:?!()[]{}^|";for(i=0;i<l.length;i++)if(-1<e.indexOf(l.charAt(i),0))return n&&alert("email address contains invalid characters"),!1;for(i=0;i<e.length;i++)if(127<e.charCodeAt(i))return n&&alert("email address contains non ascii characters."),!1;var a=e.indexOf("@",0);if(-1==a)return n&&alert("email address must contain an @"),!1;if(0==a)return n&&alert("email address must not start with @"),!1;if(-1<e.indexOf("@",a+1))return n&&alert("email address must contain only one @"),!1;if(-1==e.indexOf(".",a))return n&&alert("email address must contain a period in the domain name"),!1;if(-1!=e.indexOf("@.",0))return n&&alert("period must not immediately follow @ in email address"),!1;if(-1!=e.indexOf(".@",0))return n&&alert("period must not immediately precede @ in email address"),!1;if(-1!=e.indexOf("..",0))return n&&alert("two periods must not be adjacent in email address"),!1;var r=e.substring(e.lastIndexOf(".")+1);return!(2!=r.length&&"com"!=r&&"net"!=r&&"org"!=r&&"edu"!=r&&"int"!=r&&"mil"!=r&&"gov"!=r&"arpa"!=r&&"biz"!=r&&"aero"!=r&&"name"!=r&&"coop"!=r&&"info"!=r&&"pro"!=r&&"museum"!=r)||(n&&alert("invalid primary domain in email address"),!1)}function valid_macs_17(e){oldmac=e.value;var t=ignoreSpaces(oldmac);if(""==t)return!0;if(6!=t.split(":").length)return alert(errmsg.err21),e.value=e.defaultValue,!1;if(-1!=oldmac.indexOf(":"))for(var n=oldmac.substring(0,oldmac.length).split(":"),l=0;l<n.length;l++){if(nameVal=n[l],len=nameVal.length,len<1||2<len)return alert(errmsg.err22),e.value=e.defaultValue,!1;for(iln=0;iln<len;iln++)if(ch=nameVal.charAt(iln).toLowerCase(),!("0"<=ch&&ch<="9"||"a"<=ch&&ch<="f"))return alert(errmsg.err23+nameVal+errmsg.err24+oldmac+"."),e.value=e.defaultValue,!1}return e.value=e.value.toUpperCase(),"FF:FF:FF:FF:FF:FF"==e.value&&(alert(errmsg.err19),e.value=e.defaultValue),m3=e.value.charAt(1),1==(1&m3)&&(alert(errmsg.err16),e.value=e.defaultValue),!0}function ignoreSpaces(e){var t="";for(splitstring=(e=""+e).split(" "),i=0;i<splitstring.length;i++)t+=splitstring[i];return t}function check_space(e,t){for(M=unescape(t),i=0;i<e.value.length;i++)if(ch=e.value.charAt(i)," "==ch)return alert(M+errmsg.err34),e.value=e.defaultValue,!1;return!0}function valid_key(e,t){var n;if(e.value.length==2*t){for(i=0;i<2*t&&(n=parseInt(e.value.charAt(i),16),!isNaN(n));i++);i!=2*t&&(alert(errmsg.err25),e.value=e.defaultValue)}else alert(errmsg.err26),e.value=e.defaultValue}function valid_name(e,t,n){result=isascii(e,t);var l=e.value.replace(/^\s*/,"").replace(/\s*$/,"");return e.value=l,n&SPACE_NO&&(result=check_space(e,t)),result}function valid_mask(F,N,flag){var match0=-1,match1=-1,m=new Array(4);for(i=0;i<4;i++)m[i]=eval(N+"_"+i).value;if("0"==m[0]&&"0"==m[1]&&"0"==m[2]&&"0"==m[3]){if(flag&ZERO_NO)return alert(errmsg.err27),!1;if(flag&ZERO_OK)return!0}if("255"==m[0]&&"255"==m[1]&&"255"==m[2]&&"255"==m[3]){if(flag&BCST_NO)return alert(errmsg.err27),!1;if(flag&BCST_OK)return!0}for(i=3;0<=i;i--)for(j=1;j<=8;j++)m[i]%2==0?match0=8*(3-i)+j:m[i]%2==1&&-1==match1&&(match1=8*(3-i)+j),m[i]=Math.floor(m[i]/2);return!(match1<match0)||(alert(errmsg.err27),!1)}function isdigit(e,t){for("-"==e.value.charAt(0)?i=1:i=0,i;i<e.value.length;i++)if(ch=e.value.charAt(i),ch<"0"||"9"<ch)return alert(t+errmsg.err28),e.value=e.defaultValue,!1;return!0}function isascii(e,t){for(i=0;i<e.value.length;i++)if(ch=e.value.charAt(i),ch<" "||"~"<ch)return alert('"'+t+'"'+errmsg.err29),e.value=e.defaultValue,!1;return!0}function isxdigit(e,t){for(i=0;i<e.value.length;i++)if(ch=e.value.charAt(i).toLowerCase(),!("0"<=ch&&ch<="9"||"a"<=ch&&ch<="f"))return alert(t+errmsg.err30),e.value=e.defaultValue,!1;return!0}function closeWin(e){(null!=e&&e.close||null!=e&&0==e.closed)&&e.close()}function valid_ip(F,N,M1,flag){var m=new Array(4);for(M=unescape(M1),i=0;i<4;i++)m[i]=eval(N+"_"+i).value;return 127==m[0]||224==m[0]?(alert(M+errmsg.err31),!1):"0"==m[0]&&"0"==m[1]&&"0"==m[2]&&"0"==m[3]&&flag&ZERO_NO?(alert(M+errmsg.err31),!1):"0"==m[0]&&"0"==m[1]&&"0"==m[2]||"0"!=m[3]||!(flag&MASK_NO)||(alert(M+errmsg.err31),!1)}function valid_ip_str(e,t){if(""==e.value||" "==e.value)return!0;var n=new Array(4),l=e.value.split(".");for(i=0;i<4;i++)if(n[i]=parseInt(l[i],10),isNaN(n[i]))return alert(t+errmsg.err31),e.value=e.defaultValue,!1;return 127==n[0]||224==n[0]?(alert(t+errmsg.err31),e.value=e.defaultValue,!1):!(("255"<n[0]||"255"<n[1]||"255"<n[2])&&"255"<n[3])||(alert(t+errmsg.err31),e.value=e.defaultValue,!1)}function valid_ip_gw(F,I,N,G){var IP=new Array(4),NM=new Array(4),GW=new Array(4);for(i=0;i<4;i++)IP[i]=eval(I+"_"+i).value;for(i=0;i<4;i++)NM[i]=eval(N+"_"+i).value;for(i=0;i<4;i++)GW[i]=eval(G+"_"+i).value;for(i=0;i<4;i++)if((IP[i]&NM[i])!=(GW[i]&NM[i]))return alert(errmsg.err32),!1;return IP[0]!=GW[0]||IP[1]!=GW[1]||IP[2]!=GW[2]||IP[3]!=GW[3]||(alert(errmsg.err33),!1)}function fix_cr(e){var t=new RegExp("&#13;&#10;","gi"),n=new RegExp("&#13;","gi"),l=new RegExp("&#10;","gi"),i=new RegExp("&#38;","gi"),a=new RegExp("&#34;","gi"),r=new RegExp("&#62;","gi"),s=new RegExp("&#60;","gi"),o=new RegExp("&#92;","gi"),u=new RegExp("&#39;","gi");return e.replace(t,"\n").replace(n,"\n").replace(l,"\n").replace(i,"&").replace(a,'"').replace(r,">").replace(s,"<").replace(o,"\\").replace(u,"'")}var w3c=!!document.getElementById,ie=!!document.all,N=-1;function createBar(e,t,n,l,i,a){if(ie||w3c){var r='<div class="progressbar" id="_xpbar'+ ++N+'" style="width:'+e+"px; height:"+t+'px;">';r+='<span class="progressbarblock" id="blocks'+N+'" style="left:-'+(2*t+1)+'px;">';for(var s=0;s<l;s++)r+='<span class="progressbarblock" style="left:-'+(t*s+s)+"px; width:"+t+"px; height:"+t+"px; ",r+=ie?"filter:alpha(opacity="+(100-s*(100/l))+")":"-Moz-opacity:"+(100-s*(100/l))/100,r+='"></span>';r+="</span></div>",document.write(r);var o=ie?document.all["blocks"+N]:document.getElementById("blocks"+N);return o.bar=ie?document.all["_xpbar"+N]:document.getElementById("_xpbar"+N),o.blocks=l,o.N=N,o.w=e,o.h=t,o.speed=n,o.ctr=0,o.count=i,o.action=a,o.togglePause=togglePause,o.showBar=function(){this.bar.style.visibility="visible"},o.hideBar=function(){this.bar.style.visibility="hidden"},o.tid=setInterval("startBar("+N+")",n),o}return!1}function startBar(bn){var t=ie?document.all["blocks"+bn]:document.getElementById("blocks"+bn);parseInt(t.style.left)+t.h+1-(t.blocks*t.h+t.blocks)>t.w?(t.style.left=-(2*t.h+1)+"px",t.ctr++,t.ctr>=t.count&&(eval(t.action),t.ctr=0)):t.style.left=parseInt(t.style.left)+t.h+1+"px"}function togglePause(){0==this.tid?this.tid=setInterval("startBar("+this.N+")",this.speed):(clearInterval(this.tid),this.tid=0)}function change_style(e,t){document.getElementById(e).className=t}function Capture(e){document.write(e)}function defined(e){return void 0!==e}function cleanTable(e){for(var t=e.rows.length-1;0<t;t--)e.deleteRow(t)}function openHelpWindow(e){var t=Math.floor(.66*screen.availWidth)-10,n=Math.floor(.33*screen.availWidth),l=Math.floor(.9*screen.availHeight)-30;window.open("help/"+e,"DDWRT_Help","top=30,left="+t+",width="+n+",height="+l+",resizable=yes,scrollbars=yes,statusbar=no").focus()}function openHelpWindowExt(e){var t=Math.floor(.66*screen.availWidth)-10,n=Math.floor(.33*screen.availWidth),l=Math.floor(.9*screen.availHeight)-30;window.open("http://www.dd-wrt.com/help/english/"+e,"DDWRT_Help","top=30,left="+t+",width="+n+",height="+l+",resizable=yes,scrollbars=yes,statusbar=no").focus()}function openAboutWindow(){var e=Math.floor((screen.availHeight-650-10)/2),t=Math.floor((screen.availWidth-750)/2);window.open("About.htm","DDWRT_About","top="+e+",left="+t+",width=750,height=650,resizable=no,scrollbars=no,statusbar=no").focus()}function openWindow(e,t,n,l){l=l||e.replace(/\.asp/,"");var i=Math.floor((screen.availHeight-n-10)/2),a=Math.floor((screen.availWidth-t)/2),r=window.open(e,"DDWRT_"+l,"top="+i+",left="+a+",width="+t+",height="+n+",resizable=yes,scrollbars=yes,statusbar=no");addEvent(window,"unload",function(){r.closed||r.close()}),r.focus()}function setMeterBar(e,t,n){isNaN(t)&&(t=0),t=Math.max(0,Math.min(100,Math.round(t)))+"%";var l="string"==typeof e?document.getElementById(e):e;l.firstChild?(l.firstChild.childNodes[0].style.width=t,l.firstChild.childNodes[1].firstChild.data=t,defined(n)&&(l.lastChild.data=n)):l.innerHTML='<div class="meter"><div class="bar" style="width:'+t+';"></div><div class="text">'+t+"</div></div>"+(defined(n)?n:"")}function setElementContent(e,t){document.getElementById(e)&&(document.getElementById(e).innerHTML=t)}function setElementVisible(e,t){document.getElementById(e)&&(document.getElementById(e).style.display=t?"":"none")}function setElementActive(e,t){var n=document.getElementsByName(e);if(n)for(var l=0;l<n.length;l++)n[l].disabled=!t}function setElementsActive(e,t,n){if(document.forms[0].elements[e]&&document.forms[0].elements[t])for(var l=!1,i=0;i<document.forms[0].elements.length;i++){var a=document.forms[0].elements[i].name;if(document.forms[0].elements[i].type&&(a==e||l)&&(l=!0,document.forms[0].elements[i].disabled=!n,a==t))break}}function addEvent(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n)}function removeEvent(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent&&e.detachEvent("on"+t,n)}function StatusUpdate(e,t){var a,r,n=e,s=1e3*t,o=this,u=new Object,d=new Object;this.start=function(){return!(!window.XMLHttpRequest&&!window.ActiveXObject||0==s)&&(document.getElementsByName("refresh_button").length&&(document.getElementsByName("refresh_button")[0].disabled=!0),r=setTimeout(o.doUpdate,s),!0)},this.stop=function(){clearTimeout(r),document.getElementsByName("refresh_button").length&&(document.getElementsByName("refresh_button")[0].disabled=!1),a=null},this.onUpdate=function(e,t){u[e]=t},this.doUpdate=function(){a&&a.readyState<4||(window.XMLHttpRequest&&(a=new XMLHttpRequest),window.ActiveXObject&&(a=new ActiveXObject("Microsoft.XMLHTTP")),a.open("GET",n,!0),a.onreadystatechange=function(){if(!(a.readyState<4||200!=a.status)){for(var e=new Array,t=/\{(\w+)::([^\}]*)\}/g;result=t.exec(a.responseText);){var n=result[1],l=result[2];defined(d[n])&&d[n]==l||(d[n]=l,defined(u[n])&&e.push(u[n]),setElementContent(n,l))}for(var i=0;i<e.length;i++)e[i](d);r=setTimeout(o.doUpdate,s)}},a.send(""))},this.forceUpdate=function(){this.stop(),this.doUpdate()}}function StatusbarUpdate(){var a,r,s=this,o=new Object,u=new Object;this.start=function(){return!(!window.XMLHttpRequest&&!window.ActiveXObject)&&(r=setTimeout(s.doUpdate,5e3),!0)},this.stop=function(){clearTimeout(r),a=null},this.onUpdate=function(e,t){o[e]=t},this.doUpdate=function(){a&&a.readyState<4||(window.XMLHttpRequest&&(a=new XMLHttpRequest),window.ActiveXObject&&(a=new ActiveXObject("Microsoft.XMLHTTP")),a.open("GET","Statusinfo.live.asp",!0),a.onreadystatechange=function(){if(!(a.readyState<4||200!=a.status)){for(var e=new Array,t=/\{(\w+)::([^\}]*)\}/g;result=t.exec(a.responseText);){var n=result[1],l=result[2];defined(u[n])&&u[n]==l||(u[n]=l,defined(o[n])&&e.push(o[n]),setElementContent(n,l))}for(var i=0;i<e.length;i++)e[i](u);r=setTimeout(s.doUpdate,5e3)}},a.send(""))}}function invalidTextValue(e){var t=new Array("<",">");if(e){var n=0,l="";for(n=0;n<t.length;n++)re=new RegExp(t[n]),e.match(re)&&(l=l.length?l+", "+t[n]:t[n]);if(l.length)return l}return!1}function getInputLabel(e,t){for(var n=document.getElementsByTagName(e),l=0;l<n.length;l++)if(n[l].name==t&&n[l].parentNode.children&&"label"==n[l].parentNode.children[0].className)return n[l].parentNode.children[0].innerHTML.match(/[^>]+$/);return t}function checkformelements(e){var t=0;for(t=0;t<e.elements.length;t++)if("no-check"==e.elements[t].className);else if("text"==e.elements[t].type&&(chars=invalidTextValue(e.elements[t].value)))return alert(errmsg.err112.replace("<invchars>",chars).replace("<fieldname>",getInputLabel("input",e.elements[t].name))),e.elements[t].style.border="solid 2px #f00",e.elements[t].focus(),!1;return!0}function apply(e){if(!checkformelements(e))return!1;for(e.submit(),i=0;i<e.elements.length;i++)defined(e.elements[i].disabled)&&(e.elements[i].disabled=!0);e.contents&&(document.getElementById("contents").style.color="#999999")}function applytake(e){if(!checkformelements(e))return!1;for(e.action.value="ApplyTake",e.submit(),i=0;i<e.elements.length;i++)defined(e.elements[i].disabled)&&(e.elements[i].disabled=!0);e.contents&&(document.getElementById("contents").style.color="#999999")}function applyupdate(e){for(e.submit(),i=0;i<e.elements.length;i++)defined(e.elements[i].disabled)&&(e.elements[i].disabled=!0);e.contents&&(document.getElementById("contents").style.color="#999999")}function getOUIFromMAC(e){var t=Math.floor(.66*screen.availWidth)-10,n=new Array;n=e.split(e.substr(2,1));var l=window.open("https://oidsearch.s.dd-wrt.com/search/"+n[0]+":"+n[1]+":"+n[2],"DDWRT_OUI_Search","top=30,left="+t+",width=700,height=400,resizable=yes,scrollbars=yes,statusbar=no");addEvent(window,"unload",function(){l.closed||l.close()}),l.focus()}function openBW(e){var t=Math.floor(.66*screen.availWidth)-10,n=window.open("graph_if.svg?"+e,"Bandwidth","top=30,left="+t+",width=555,height=275,resizable=yes,scrollbars=yes,statusbar=no");addEvent(window,"unload",function(){n.closed||n.close()}),n.focus()}function setElementMask(e,t){var n=document.getElementById(e);if(n){var l=n.value,i=n.maxlength,a=n.size,r=n.onblur,s=n.parentNode,o=n.nextSibling,u=n.className,d=document.createElement("input");d.setAttribute("value",l),d.setAttribute("name",e),d.setAttribute("id",e),d.setAttribute("maxlength",i),d.setAttribute("size",a),d.className=u,d.setAttribute("rel",n.getAttribute("rel")),d.onblur=r,1==t?d.setAttribute("type","text"):d.setAttribute("type","password"),s.removeChild(n),s.insertBefore(d,o),d.focus()}}var windo={getWindoSize:function(){return window.innerHeight?{height:window.innerHeight,width:window.innerWidth}:document.documentElement&&document.documentElement.clientHeight?{height:document.documentElement.clientHeight,width:document.documentElement.clientWidth}:{Height:document.body.clientHeight,width:document.body.clientWidth}}};function show_layer_ext(obj,id,state){obj&&(state?(visibility_style="visible",display_style="block"):(visibility_style="hidden",display_style="none"),ie4&&(eval("document.all."+id+".style.visibility='"+visibility_style+"'"),eval("document.all."+id+".style.display='"+display_style+"'")),ns4&&(eval("document."+id+".visibility='"+visibility_style+"'"),eval("document."+id+".display='"+display_style+"'")),(ns6||op)&&(eval("document.getElementById('"+id+"').style.visibility='"+visibility_style+"'"),eval("document.getElementById('"+id+"').style.display='"+display_style+"'")))}function toggle_layer_ext(e,t,n,l){show_layer_ext(e,t,l),show_layer_ext(e,n,!l)}function lgout(){document.forms[0].action.value="Logout",document.forms[0].submit()}function comma(e){for(var t=e=""+e;(e=e.replace(/(\d+)(\d{3})/g,"$1\u202f$2"))!=t;)t=e;return e}function scaleSize(e){if(isNaN(e*=1))return"-";if(e<=9999)return""+e;for(var t=-1;++t,9999<(e/=1e3)&&t<2;);return comma(e.toFixed(2))+"<small> "+["kB","MB","GB"][t]+"</small>"}function DisplayDiv(e,t,n,l,i){var a=l,r=n;i=(i=i.replace(/&lt;/gi,"<")).replace(/&gt;/gi,">"),document.all?"complete"==document.readyState&&(document.all.bulle.innerHTML='<table class="bulle" cellspacing="0"><tr><td class="bulle">'+i+"</td></tr></table>",document.all.bulle.style.pixelLeft=event.clientX+document.body.scrollLeft+a,document.all.bulle.style.pixelTop=event.clientY+document.body.scrollTop+r,document.all.bulle.style.visibility="visible"):document.getElementById&&(document.getElementById("bulle").innerHTML='<table class="bulle" cellspacing="0"><tr><td class="bulle">'+i+"</td></tr></table>",document.getElementById("bulle").style.left=t.pageX+a+"px",document.getElementById("bulle").style.top=t.pageY+r+"px",document.getElementById("bulle").style.visibility="visible")}function unDisplayDiv(){document.all?document.all.bulle.style.visibility="hidden":document.layers?document.bulle.visibility="hidden":document.getElementById&&(document.getElementById("bulle").style.visibility="hidden")}function submitFooterButton(e,t,n,l,i,a){if(e&&document.write('<input title="'+sbutton.savetitle+'" class="button" type="button" name="save_button" value="'+sbutton.save+'" onclick="to_submit(this.form);" />'),e&&document.write('<input title="'+sbutton.applytitle+'" class="button" type="button" name="apply_button" value="'+sbutton.apply+'" onclick="to_apply(this.form);" />'),t){if(document.forms[0].elements.submit_button.value)var r="document.location=document.forms[0].elements['submit_button'].value+'.asp';";else r="window.location.reload();";document.write('<input title="'+sbutton.canceltitle+'" class="button" type="button" name="reset_button" value="'+sbutton.cancel+'" onclick="'+r+'" />')}n&&document.write('<input class="button" type="button" name="reboot_button" value="'+sbutton.reboot+'" onclick="to_reboot(this.form);" />'),l&&document.write('<input class="button" type="button" name="refresh_button" value="'+l+'" onclick="window.location.reload();">'),i&&document.write('<input class="button" type="button" name="refresh_button" value="'+sbutton.refres+'" onclick="window.location.reload();" />'),a&&document.write('<input class="button" type="button" name="close_button" value="'+sbutton.clos+'" onclick="self.close();" />')}function SortableTable(e){this.tbody=e.getElementsByTagName("tbody"),this.thead=e.getElementsByTagName("tbody"),this.getInnerText=function(e){return void 0===e?null:null==e?null:void 0!==e.textContent?e.textContent:void 0!==e.innerText?e.innerText:"string"==typeof e.innerHTML?e.innerHTML.replace(/<[^<>]+>/g,""):void 0},this.getParent=function(e,t){return null==e?null:1==e.nodeType&&e.tagName.toLowerCase()==t.toLowerCase()?e:this.getParent(e.parentNode,t)},this.sort=function(e){var t=e.cellIndex,n=this.getInnerText(this.tbody[0].rows[1].cells[t]),l=this.sortCaseInsensitive;null!=n&&n.replace(/^\s+|\s+$/g,"").match(/^[\d]+$/)&&(l=this.sortNumeric),this.sortColumnIndex=t;var i=new Array;for(j=1;j<this.tbody[0].rows.length;j++)i[j-1]=this.tbody[0].rows[j];for(i.sort(l),"down"==e.getAttribute("sortdir")?(i.reverse(),e.setAttribute("sortdir","up")):e.setAttribute("sortdir","down"),a=1;a<i.length;a++)this.tbody[0].appendChild(i[a])},this.sortCaseInsensitive=function(e,t){return aa=n.getInnerText(e.cells[n.sortColumnIndex]).toLowerCase(),bb=n.getInnerText(t.cells[n.sortColumnIndex]).toLowerCase(),aa==bb?0:aa<bb?-1:1},this.sortNumeric=function(e,t){return aa=parseFloat(n.getInnerText(e.cells[n.sortColumnIndex])),isNaN(aa)&&(aa=0),bb=parseFloat(n.getInnerText(t.cells[n.sortColumnIndex])),isNaN(bb)&&(bb=0),aa-bb};var n=this,t=this.thead;if(this.tbody&&this.tbody[0].rows&&0<this.tbody[0].rows.length&&t&&t[0].rows&&0<t[0].rows.length)for(var l=t[0].rows[0],a=0;a<l.cells.length;a++)l.cells[a].sTable=this,l.cells[a].onclick=function(){return this.sTable.sort(this),!1}}function addTableEntry(e){var t=$(e).childElements()[0],n=t.childElements(),l=null;for(i=0;i<n.length;i++)if(n[i].id&&"_template"==n[i].id.substr(n[i].id.length-9,9))for((l=document.createElement("TR")).id=e+"_row_"+(n.length-i),j=0;j<n[i].childElements().length;j++){var a=n[i].childElements()[j].cloneNode(!0);for(k=0;k<a.childElements().length;k++)a.childElements()[k].name&&(a.childElements()[k].name=a.childElements()[k].name+"_"+(n.length-i)),a.childElements()[k].id&&(a.childElements()[k].id=a.childElements()[k].id+"_"+(n.length-i));l.appendChild(a)}return null!=l?(t.appendChild(l),$(e+"_count")&&$(e+"_count").value++,$(e+"_add")&&$(e+"_count_limit")&&$(e+"_count_limit").value<=n.length-2&&$(e+"_add").hide(),t.childElements()[t.childElements().length-1]):null}function removeTableEntry(e,t){if(0<=t.name.indexOf("_del_")){var n=parseInt(t.name.substr(t.name.indexOf("_del_")+5,t.name.length-t.name.indexOf("_del_")-5));if(0<n){var l=$(e).childElements()[0],a=$(e+"_row_"+n);l.removeChild(a);var r=l.childElements(),s=e+"_row_";for(i=0;i<r.length;i++)if(r[i].id.substr(0,s.length)==s&&"_template"!=r[i].id.substr(r[i].id.length-9,9)){var o=parseInt(r[i].id.substr(s.length,r[i].id.length-s.length));if(n<o)for(r[i].id=s+(o-1),j=0;j<r[i].childElements().length;j++){var u=r[i].childElements()[j];for(k=0;k<u.childElements().length;k++){if(u.childElements()[k].name){var d=u.childElements()[k].name;d=d.substr(0,d.length-String(o).length),u.childElements()[k].name=d+String(o-1)}if(u.childElements()[k].id){var c=u.childElements()[k].id;c=c.substr(0,c.length-String(o).length),u.childElements()[k].id=c+String(o-1)}}}}$(e+"_count")&&$(e+"_count").value--,$(e+"_add")&&$(e+"_count_limit")&&$(e+"_count_limit").value>r.length-4&&$(e+"_add").show()}}}
